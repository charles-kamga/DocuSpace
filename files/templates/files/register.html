{% extends 'files/base.html' %}

{% block title %}Inscription{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center py-5">
        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
            <div class="card shadow-sm">
                <div class="card-header bg-white text-center py-4">
                    <h2 class="h4 mb-0">
                        <i class="fas fa-user-plus text-primary me-2"></i>Créer un compte
                    </h2>
                </div>
                <div class="card-body p-4">
                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}
                        
                        {% if form.errors %}
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle me-2"></i>
                            Veuillez corriger les erreurs ci-dessous.
                        </div>
                        {% endif %}
                        
                        <div class="mb-3">
                            <label for="id_username" class="form-label">Nom d'utilisateur</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                                <input type="text" class="form-control form-control-lg {% if form.username.errors %}is-invalid{% endif %}" 
                                       id="id_username" name="username" required
                                       value="{{ form.username.value|default:'' }}"
                                       placeholder="Choisissez un nom d'utilisateur">
                            </div>
                            {% if form.username.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.username.errors.0 }}
                                </div>
                            {% else %}
                                <div class="form-text">150 caractères maximum. Uniquement des lettres, chiffres et @/./+/-/_.</div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-3">
                            <label for="id_password1" class="form-label">Mot de passe</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input type="password" class="form-control form-control-lg {% if form.password1.errors %}is-invalid{% endif %}" 
                                       id="id_password1" name="password1" required
                                       placeholder="Créez un mot de passe">
                            </div>
                            {% if form.password1.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.password1.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-4">
                            <label for="id_password2" class="form-label">Confirmation du mot de passe</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                <input type="password" class="form-control form-control-lg {% if form.password2.errors %}is-invalid{% endif %}" 
                                       id="id_password2" name="password2" required
                                       placeholder="Confirmez votre mot de passe">
                            </div>
                            {% if form.password2.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.password2.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-user-plus me-2"></i>S'inscrire
                            </button>
                        </div>
                    </form>
                </div>
                <div class="card-footer bg-white text-center py-3">
                    <p class="mb-0">
                        Déjà inscrit ? 
                        <a href="{% url 'login' %}" class="text-primary text-decoration-underline">
                            Se connecter
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Validation des champs du formulaire
(function () {
    'use strict'
    
    // Récupérer tous les formulaires auxquels nous voulons appliquer le style de validation Bootstrap
    var forms = document.querySelectorAll('.needs-validation')
    
    // Boucle sur les champs et empêcher la soumission
    Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
            
            form.classList.add('was-validated')
        }, false)
    })
})()
</script>
{% endblock %}
